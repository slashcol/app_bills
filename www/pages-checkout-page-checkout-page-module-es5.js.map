{"version":3,"sources":["webpack:///src/app/pages/checkout-page/checkout-page.module.ts","webpack:///src/app/pages/checkout-page/checkout-page.html","webpack:///src/app/pages/checkout-page/checkout-page.ts"],"names":["CheckoutPageModule","forChild","path","component","declarations","imports","CheckoutPage","injector","cardService","cartService","appConfig","currencyGlobalPipe","customerAddressService","addresses","cards","setupForm","loginListener","onPlaceOrder","document","addEventListener","user","getCurrent","contactEmail","attributes","email","form","shipping","required","card","paymentMethod","couponCode","setupEvents","showLoadingView","showOverlay","loadCart","showEmptyView","getTrans","title","setPageTitle","setMetaTags","removeEventListener","isUpdatingCart","cart","removeCoupon","translate","get","subscribe","str","showToast","value","trim","applyCoupon","showCouponErrorsIfNeeded","error","code","matches","message","match","formattedValue","transform","load","isCardEnabled","admin","isCodEnabled","minimumOrderAmount","maximumOrderAmount","getOne","status","window","dispatchEvent","CustomEvent","detail","goBack","empty","length","find","address","id","controls","setValue","onChangeAddress","showContentView","showErrorView","modalCtrl","create","modal","present","onWillDismiss","data","save","shippingField","event","target","clearValidators","updateValueAndValidity","setValidators","formData","Object","assign","order","contact","componentProps","showSignUpForm","hasError","invalid","isCreatingOrder","prepareOrderData","setRelativeRoot","onPresentSignUpModal","selector","templateUrl","styleUrls","providers"],"mappings":"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","file":"pages-checkout-page-checkout-page-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { CheckoutPage } from './checkout-page';\nimport { SharedModule } from '../../shared.module';\nimport { CardListModalPageModule } from '../card-list-modal/card-list.module';\nimport { AddressListModalPageModule } from '../address-list-modal/address-list.module';\nimport { AddressAddPageModule } from '../address-add/address-add.module';\nimport { CardAddPageModule } from '../card-add/card-add.module';\nimport { FormsModule } from '@angular/forms';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { SignInPageModule } from '../sign-in/sign-in.module';\n\n@NgModule({\n  declarations: [\n    CheckoutPage,\n  ],\n  imports: [\n    RouterModule.forChild([\n      {\n        path: '',\n        component: CheckoutPage\n      }\n    ]),\n    SharedModule,\n    FormsModule,\n    ReactiveFormsModule,\n    AddressAddPageModule,\n    CardAddPageModule,\n    SignInPageModule,\n  ],\n})\nexport class CheckoutPageModule {}\n","<ion-header class=\"ion-no-border\">\n\n  <ion-toolbar fixed>\n    <ion-buttons slot=\"start\">\n      <ion-back-button></ion-back-button>\n    </ion-buttons>\n    <ion-title>{{ 'CHECKOUT' | translate }}</ion-title>\n  </ion-toolbar>\n\n</ion-header>\n\n<ion-content>\n\n  <ion-grid fixed>\n\n    <empty-view *ngIf=\"isErrorViewVisible\" icon=\"alert-circle-outline\" [text]=\"'ERROR_DATA' | translate\">\n    </empty-view>\n\n    <empty-view *ngIf=\"isEmptyViewVisible\" image=\"./assets/imgs/undraw_add_to_cart_vkjp.svg\" imageWidth=\"120\"\n      [text]=\"'CART_EMPTY' | translate\">\n    </empty-view>\n\n    <form [formGroup]=\"form\" #ngForm=\"ngForm\" (ngSubmit)=\"onPlaceOrder()\" novalidate *ngIf=\"isContentViewVisible\">\n\n      <ion-row *ngIf=\"isContentViewVisible\">\n        <ion-col size-xs=\"12\" size-lg=\"7\">\n\n          <div class=\"alert alert-warning\" *ngIf=\"minimumOrderAmount && cart?.subtotal < minimumOrderAmount\">\n            {{ 'ERROR_MINIMUM_ORDER_AMOUNT' | translate: { value: (minimumOrderAmount | currencyGlobal) } }}\n          </div>\n\n          <div class=\"alert alert-warning\" *ngIf=\"maximumOrderAmount && cart?.subtotal > maximumOrderAmount\">\n            {{ 'ERROR_MAXIMUM_ORDER_AMOUNT' | translate: { value: (maximumOrderAmount | currencyGlobal) } }}\n          </div>\n\n          <ion-item-group class=\"ion-margin-vertical\">\n            <ion-list-header class=\"ion-margin-bottom bold\">\n              <h5>{{ 'CONTACT_INFO' | translate }}</h5>\n            </ion-list-header>\n            <ion-item class=\"text-medium item-input ion-margin-horizontal\" lines=\"none\">\n              <ion-input type=\"email\" formControlName=\"contactEmail\" [placeholder]=\"'CONTACT_EMAIL' | translate\">\n              </ion-input>\n            </ion-item>\n          </ion-item-group>\n\n          <ion-item-group class=\"ion-margin-vertical\">\n            <ion-list-header class=\"ion-margin-bottom bold\">\n              <h5>{{ 'PAYMENT' | translate }}</h5>\n            </ion-list-header>\n            <ion-list lines=\"none\" class=\"ion-no-padding ion-no-margin\">\n\n              <p class=\"text-medium ion-padding-horizontal ion-no-margin\" *ngIf=\"!isCardEnabled && !isCodEnabled\">\n                {{ 'PAYMENT_METHOD_NOT_FOUND' | translate }}\n              </p>\n\n              <ion-radio-group mode=\"md\" (ionChange)=\"onChangePaymentMethod($event)\" formControlName=\"paymentMethod\">\n                <ion-item *ngIf=\"isCodEnabled\">\n                  <ion-label>\n                    <p>{{ 'CASH' | translate }}</p>\n                  </ion-label>\n                  <ion-radio value=\"Cash\"></ion-radio>\n                </ion-item>\n                <ion-item lines=\"none\" *ngIf=\"isCardEnabled\">\n                  <ion-label>\n                    <p>{{ 'CREDIT_DEBIT_CARD' | translate }}</p>\n                  </ion-label>\n                  <ion-radio value=\"Card\"></ion-radio>\n                </ion-item>\n              </ion-radio-group>\n            </ion-list>\n\n            <ion-list [hidden]=\"paymentMethodField.value !== 'Card'\">\n              <ion-radio-group mode=\"md\" formControlName=\"card\">\n                <ion-item *ngFor=\"let card of cards\">\n                  <ion-label class=\"flex align-items-center\">\n                    &nbsp;&nbsp;&nbsp;&nbsp;<img src=\"./assets/imgs/{{card.formatBrand()}}.png\" width=\"30\" />\n                    &nbsp;&nbsp;<span class=\"text-medium\" [innerHTML]=\"card\"></span>\n                  </ion-label>\n                  <ion-radio [value]=\"card\" color=\"dark\"></ion-radio>\n                </ion-item>\n                <ion-item>\n                  <ion-button strong type=\"button\" class=\"ion-text-capitalize\" size=\"small\"\n                    (click)=\"onPresentCardAddModal()\">\n                    {{ 'ADD_CARD' | translate }}\n                  </ion-button>\n                </ion-item>\n              </ion-radio-group>\n            </ion-list>\n\n          </ion-item-group>\n\n          <ion-list-header class=\"ion-margin-bottom bold\">\n            <h5>{{ 'SHIPPING' | translate }}</h5>\n          </ion-list-header>\n\n          <ion-list class=\"ion-no-padding\">\n            <ion-radio-group mode=\"md\" formControlName=\"shipping\" (ionChange)=\"onChangeAddress()\">\n              <ion-item *ngFor=\"let address of addresses\">\n                <ion-label>\n                  <p>\n                    <ion-text color=\"dark\">\n                      {{ address }}\n                    </ion-text>\n                  </p>\n                  <p class=\"text-small\">\n                    {{ 'CONTACT_PHONE' | translate }}: {{ address.phone }}\n                  </p>\n                </ion-label>\n                <ion-radio [value]=\"address\" color=\"dark\"></ion-radio>\n              </ion-item>\n              <ion-item>\n                <ion-button strong type=\"button\" class=\"ion-text-capitalize\" size=\"small\"\n                  (click)=\"onPresentAddressAddModal()\">\n                  {{ 'ADD_NEW_ADDRESS' | translate }}\n                </ion-button>\n              </ion-item>\n            </ion-radio-group>\n          </ion-list>\n\n        </ion-col>\n        <ion-col size-xs=\"12\" size-lg=\"5\">\n\n          <ion-list-header class=\"bold ion-margin-top\">\n            <h5>{{ 'ORDER_SUMMARY' | translate }}</h5>\n          </ion-list-header>\n\n          <div class=\"bg-light radius ion-padding ion-margin-top\">\n\n            <ion-item-group class=\"ion-margin-vertical\">\n\n              <ion-item style=\"--padding-start:0\" color=\"light\" [lines]=\"last ? 'none' : 'full'\"\n                *ngFor=\"let item of cart?.items; let last = last\">\n                <ion-thumbnail slot=\"start\" *ngIf=\"item.featuredImageThumb\">\n                  <img src-fallback=\"./assets/imgs/placeholder.png\" [src]=\"item.featuredImageThumb?.url()\" />\n                </ion-thumbnail>\n                <ion-row class=\"full-width\">\n                  <ion-col>\n                    <ion-label>\n                      <p class=\"text-normal ellipsis mb-8\">\n                        {{ item.qty }} x {{ item.name }}\n                      </p>\n                      <p *ngIf=\"item.variation\">\n                        <span class=\"bold\">{{ 'VARIANT' | translate }}:</span> {{ item.variation.name }}\n                      </p>\n                    </ion-label>\n                  </ion-col>\n                </ion-row>\n                <div slot=\"end\">\n\n                  <p class=\"text-medium\" *ngIf=\"item.hasOwnProperty('finalAmount'); else showOnlyAmount\">\n                    <span *ngIf=\"item.amount > item.finalAmount\">\n                      <ion-text color=\"medium\">\n                        <s class=\"text-small\">\n                          {{ item.amount | currencyGlobal }}\n                        </s>\n                      </ion-text>\n                      <br />\n                      <span>\n                        {{ item.finalAmount | currencyGlobal }}\n                      </span>\n                    </span>\n                    <span *ngIf=\"item.amount <= item.finalAmount\">\n                      <span>{{ item.finalAmount | currencyGlobal }}</span>\n                    </span>\n                  </p>\n\n                  <ng-template #showOnlyAmount>\n                    <p class=\"text-medium\">\n                      {{ item.amount | currencyGlobal }}\n                    </p>\n                  </ng-template>\n                  \n                </div>\n              </ion-item>\n\n            </ion-item-group>\n\n            <ion-list-header>\n              <ion-label>\n                <h5>{{ 'COUPON' | translate }}</h5>\n              </ion-label>\n            </ion-list-header>\n            <ion-item class=\"text-medium item-input ion-margin-horizontal\" lines=\"none\">\n              <ion-input type=\"text\" formControlName=\"couponCode\" [placeholder]=\"'COUPON_PLACEHOLDER' | translate\">\n              </ion-input>\n            </ion-item>\n\n            <ion-button style=\"min-width: 140px;\" (click)=\"onApplyCouponButtonTouched()\"\n              class=\"ion-margin ion-text-capitalize\" size=\"small\" color=\"white\"\n              [disabled]=\"isUpdatingCart || isCreatingOrder\">\n              <span class=\"text-medium\">{{ 'APPLY_COUPON' | translate }}</span>\n            </ion-button>\n\n            <ion-item color=\"light\" *ngIf=\"cart?.coupon\" [class.opacity-medium]=\"isUpdatingCart\">\n              <ion-label>\n                {{ 'COUPON' | translate }}: {{ cart?.coupon?.name }}\n              </ion-label>\n              <ion-button slot=\"end\" (click)=\"onRemoveCoupon()\" fill=\"clear\"\n                [disabled]=\"isUpdatingCart || isCreatingOrder\">\n                <span class=\"ion-text-capitalize text-small\">\n                  {{ 'REMOVE_COUPON' | translate }}\n                </span>\n              </ion-button>\n            </ion-item>\n\n            <ion-row [class.opacity-medium]=\"isUpdatingCart\">\n              <ion-col class=\"ion-text-nowrap\">\n                <p>{{ 'SUBTOTAL' | translate }}</p>\n                <p *ngIf=\"cart?.coupon\">\n                  {{ 'COUPON_DISCOUNT' | translate }}\n                  ({{ cart?.coupon?.name }})\n                </p>\n                <p>{{ 'SHIPPING_FEE' | translate }}</p>\n                <p>{{ 'TOTAL' | translate }}</p>\n              </ion-col>\n              <ion-col class=\"ion-text-end\">\n                <p>{{ cart?.subtotal | currencyGlobal }}</p>\n                <p *ngIf=\"cart?.coupon\">\n                  {{ -cart?.coupon?.amount | currencyGlobal }}\n                </p>\n                <p>{{ cart?.shippingFee | currencyGlobal }}</p>\n                <p>{{ cart?.total | currencyGlobal }}</p>\n              </ion-col>\n            </ion-row>\n            <div class=\"ion-text-center\">\n              <ion-button type=\"submit\" class=\"ion-text-uppercase\" strong shape=\"round\" color=\"primary\"\n                [disabled]=\"isUpdatingCart || isCreatingOrder\">\n                <ion-spinner color=\"light\" *ngIf=\"isCreatingOrder\"></ion-spinner>\n                <span *ngIf=\"!isCreatingOrder\">{{ 'PLACE_ORDER' | translate }}</span>\n              </ion-button>\n              <p><small>{{ 'TRANSACTION_NOTICE' | translate }}</small></p>\n              <img src=\"./assets/imgs/mastercard.png\" width=\"40\" />\n              <img src=\"./assets/imgs/visa.png\" width=\"40\" />\n              <img src=\"./assets/imgs/american_express.png\" width=\"40\" />\n            </div>\n          </div>\n        </ion-col>\n      </ion-row>\n\n    </form>\n\n    <ion-row class=\"ion-margin\" *ngIf=\"isLoadingViewVisible\">\n      <ion-col size-xs=\"12\" size-lg=\"8\">\n        <ngx-skeleton-loader count=\"1\" [theme]=\"{ 'border-radius': '0', height: '120px', width: '100%' }\">\n        </ngx-skeleton-loader>\n        <ngx-skeleton-loader count=\"1\" [theme]=\"{ 'border-radius': '0', height: '120px', width: '100%' }\">\n        </ngx-skeleton-loader>\n        <ngx-skeleton-loader count=\"1\" [theme]=\"{ 'border-radius': '0', height: '240px', width: '100%' }\">\n        </ngx-skeleton-loader>\n      </ion-col>\n      <ion-col size-xs=\"12\" size-lg=\"4\">\n        <ngx-skeleton-loader count=\"1\" [theme]=\"{ 'border-radius': '0', height: '270px', width: '100%' }\">\n        </ngx-skeleton-loader>\n      </ion-col>\n    </ion-row>\n\n  </ion-grid>\n\n</ion-content>","import { Component, Injector } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { BasePage } from '../base-page/base-page';\nimport { Cart } from '../../services/cart';\nimport { Order } from '../../services/order';\nimport { User } from '../../services/user';\nimport { CustomerAddress } from '../../services/customer-address';\nimport { Card } from '../../services/card';\nimport { AppConfigService } from 'src/app/services/app-config';\nimport { CurrencyGlobalPipe } from 'src/app/pipes/currency-global';\nimport { AddressAddPage } from '../address-add/address-add';\nimport { CardAddPage } from '../card-add/card-add';\nimport { SignInPage } from '../sign-in/sign-in';\n\n@Component({\n  selector: 'checkout-page',\n  templateUrl: './checkout-page.html',\n  styleUrls: ['./checkout-page.scss'],\n  providers: [CurrencyGlobalPipe],\n})\nexport class CheckoutPage extends BasePage {\n\n  public cart: Cart;\n  public form: FormGroup;\n\n  public isCreatingOrder: boolean;\n\n  public isCodEnabled: boolean;\n  public isCardEnabled: boolean;\n\n  public minimumOrderAmount: number;\n  public maximumOrderAmount: number;\n\n  public isUpdatingCart: boolean;\n\n  public addresses: CustomerAddress[] = [];\n  public cards: Card[] = [];\n\n  public loginListener: any;\n\n  get shippingField() {\n    return this.form.get('shipping');\n  }\n\n  get paymentMethodField() {\n    return this.form.get('paymentMethod');\n  }\n\n  get contactEmailField() {\n    return this.form.get('contactEmail');\n  }\n\n  get cardField() {\n    return this.form.get('card');\n  }\n\n  constructor(injector: Injector,\n    private cardService: Card,\n    private cartService: Cart,\n    private appConfig: AppConfigService,\n    private currencyGlobalPipe: CurrencyGlobalPipe,\n    private customerAddressService: CustomerAddress) {\n    super(injector);\n  }\n\n  ngOnInit() {\n    this.setupForm();\n  }\n\n\n  enableMenuSwipe(): boolean {\n    return false;\n  }\n\n  setupEvents() {\n    this.loginListener = () => this.onPlaceOrder();\n    document.addEventListener('user:login', this.loginListener);\n  }\n\n  setupForm() {\n\n    const user = User.getCurrent();\n    const contactEmail = user.attributes.email || user.attributes.contactEmail;\n\n    this.form = new FormGroup({\n      shipping: new FormControl(null, Validators.required),\n      contactEmail: new FormControl(contactEmail, [\n        Validators.required,\n        Validators.email,\n      ]),\n      card: new FormControl(null),\n      paymentMethod: new FormControl('', Validators.required),\n      couponCode: new FormControl(''),\n    });\n  }\n\n  async ionViewDidEnter() {\n\n    this.setupEvents();\n\n    if (User.getCurrent()) {\n      this.showLoadingView({ showOverlay: false });\n      this.loadCart();\n    } else {\n      this.showEmptyView();\n    }\n\n    const title = await this.getTrans('CHECKOUT');\n    this.setPageTitle(title);\n\n    this.setMetaTags({\n      title: title\n    });\n  }\n\n  ionViewDidLeave() {\n    document.removeEventListener('user:login', this.loginListener);\n  }\n\n  async onRemoveCoupon() {\n    try {\n\n      this.isUpdatingCart = true;\n      const cart = await this.cart.removeCoupon();\n      this.cart = cart;\n      this.isUpdatingCart = false;\n\n      this.translate.get('COUPON_REMOVED')\n        .subscribe(str => this.showToast(str));\n\n    } catch (error) {\n      this.isUpdatingCart = false;\n\n      this.translate.get('ERROR_NETWORK')\n        .subscribe(str => this.showToast(str));\n    }\n  }\n\n  async onApplyCouponButtonTouched() {\n\n    const couponCode = (this.form.value.couponCode || '').trim();\n\n    if (!couponCode) return;\n\n    try {\n\n      this.isUpdatingCart = true;\n      const cart = await this.cart.applyCoupon(couponCode);\n      this.cart = cart;\n      this.isUpdatingCart = false;\n\n      this.translate.get('COUPON_CODE_APPLIED')\n        .subscribe(str => this.showToast(str));\n\n    } catch (error) {\n      this.isUpdatingCart = false;\n      this.showCouponErrorsIfNeeded(error);\n    }\n\n  }\n\n  showCouponErrorsIfNeeded(error: any) {\n    if (error.code === 5000) {\n      this.translate.get('COUPON_NOT_FOUND')\n        .subscribe(str => this.showToast(str));\n    } else if (error.code === 5001) {\n      this.translate.get('COUPON_INACTIVE')\n        .subscribe(str => this.showToast(str));\n    } else if (error.code === 5002) {\n      this.translate.get('COUPON_USAGE_LIMIT_REACHED')\n        .subscribe(str => this.showToast(str));\n    } else if (error.code === 5003) {\n      this.translate.get('COUPON_NOT_STARTED_YET')\n        .subscribe(str => this.showToast(str));\n    } else if (error.code === 5004) {\n      this.translate.get('COUPON_EXPIRED')\n        .subscribe(str => this.showToast(str));\n    } else if (error.code === 5005) {\n      this.translate.get('COUPON_USAGE_LIMIT_PER_USER_REACHED')\n        .subscribe(str => this.showToast(str));\n    } else if (error.code === 5006) {\n\n      const matches = error.message.match(/\\%(.*?)\\%/);\n\n      if (matches) {\n        const value = matches[1];\n        const formattedValue = this.currencyGlobalPipe.transform(value);\n        this.translate.get('ERROR_MINIMUM_AMOUNT_COUPON', { value: formattedValue })\n          .subscribe(str => this.showToast(str));\n      }\n\n    } else if (error.code === 5007) {\n\n      const matches = error.message.match(/\\%(.*?)\\%/);\n\n      if (matches) {\n        const value = matches[1];\n        const formattedValue = this.currencyGlobalPipe.transform(value);\n        this.translate.get('ERROR_MAXIMUM_AMOUNT_COUPON', { value: formattedValue })\n          .subscribe(str => this.showToast(str));\n      }\n\n    } else if (\n      error.code === 5008 ||\n      error.code === 5009 ||\n      error.code === 5010 ||\n      error.code === 5011 ||\n      error.code === 5012 ||\n      error.code === 5013 ||\n      error.code === 5014 ||\n      error.code === 5015 ||\n      error.code === 5016) {\n      this.translate.get('CANNOT_APPLY_COUPON')\n        .subscribe(str => this.showToast(str));\n    } else {\n      this.translate.get('ERROR_NETWORK')\n        .subscribe(str => this.showToast(str));\n    }\n  }\n\n  async loadCart() {\n\n    try {\n\n      const appConfig = await this.appConfig.load();\n\n      this.isCardEnabled = appConfig.admin?.isCardEnabled;\n      this.isCodEnabled = appConfig.admin?.isCodEnabled;\n\n      this.minimumOrderAmount = appConfig.admin?.minimumOrderAmount;\n      this.maximumOrderAmount = appConfig.admin?.maximumOrderAmount;\n\n      this.cart = await this.cartService.getOne();\n\n      if (this.cart && this.cart.status === 'expired') {\n        window.dispatchEvent(new CustomEvent('cart:expired', {\n          detail: this.cart\n        }));\n        return this.goBack();\n      }\n\n      if (this.cart && !this.cart.empty()) {\n\n        this.addresses = await this.customerAddressService.load();\n\n        if (this.cart.shipping && this.addresses.length) {\n          const shipping = this.addresses.find(address => {\n            return address.id === this.cart.shipping.id\n          });\n          this.form.controls.shipping.setValue(shipping)\n          this.onChangeAddress();\n        } else if (this.addresses.length) {\n          this.form.controls.shipping.setValue(this.addresses[0]);\n          this.onChangeAddress();\n        }\n\n        this.cards = await this.cardService.load();\n\n        if (this.cards.length) {\n          const card = this.cards[0];\n          this.form.controls.card.setValue(card);\n        }\n\n        this.showContentView();\n      } else {\n        this.showEmptyView();\n      }\n\n    } catch (error) {\n      this.showErrorView();\n      this.translate.get('ERROR_NETWORK')\n        .subscribe(str => this.showToast(str));\n    }\n  }\n\n  async onPresentCardAddModal() {\n    await this.showLoadingView({ showOverlay: true });\n\n    const modal = await this.modalCtrl.create({\n      component: CardAddPage,\n    });\n\n    await modal.present();\n\n    this.showContentView();\n\n    const { data } = await modal.onWillDismiss();\n\n    if (data) {\n      this.cards = [data, ...this.cards];\n      this.form.controls.card.setValue(data);\n    }\n  }\n\n  async onPresentAddressAddModal() {\n    await this.showLoadingView({ showOverlay: true });\n\n    const modal = await this.modalCtrl.create({\n      component: AddressAddPage,\n    });\n\n    await modal.present();\n\n    this.showContentView();\n\n    const { data } = await modal.onWillDismiss();\n\n    if (data) {\n      this.addresses = [data, ...this.addresses];\n      this.form.controls.shipping.setValue(data);\n    }\n  }\n\n  async onChangeAddress() {\n    try {\n      this.isUpdatingCart = true;\n      await this.cart.save({\n        shipping: this.shippingField.value\n      });\n      this.isUpdatingCart = false;\n    } catch {\n      this.isUpdatingCart = false;\n    }\n  }\n\n  onChangePaymentMethod(event: any = {}) {\n\n    const paymentMethod = event.target.value;\n\n    if (paymentMethod === 'Cash') {\n      this.form.controls.card.clearValidators();\n      this.form.controls.card.setValue(null);\n      this.form.controls.card.updateValueAndValidity();\n    } else if (paymentMethod === 'Card') {\n      this.form.controls.card.setValidators(Validators.required);\n      this.form.controls.card.updateValueAndValidity();\n    }\n  }\n\n  prepareOrderData(): Order {\n\n    const formData = Object.assign({}, this.form.value);\n\n    const order = new Order;\n\n    order.paymentMethod = formData.paymentMethod;\n    order.card = formData.card;\n    order.contact = { email: formData.contactEmail };\n\n    return order;\n  }\n\n  async onPresentSignUpModal() {\n\n    await this.showLoadingView({ showOverlay: true });\n\n    const modal = await this.modalCtrl.create({\n      component: SignInPage,\n      componentProps: {\n        showSignUpForm: true\n      }\n    });\n\n    await modal.present();\n\n    this.showContentView();\n  }\n\n  async onPlaceOrder() {\n\n    try {\n\n      if (this.form.controls['contactEmail'].hasError('required')) {\n        const message = await this.getTrans('CHECKOUT_EMAIL_REQUIRED');\n        return this.showToast(message);\n      } else if (this.form.controls['contactEmail'].hasError('email')) {\n        const message = await this.getTrans('CHECKOUT_EMAIL_INVALID');\n        return this.showToast(message);\n      } else if (this.form.controls['shipping'].hasError('required')) {\n        const message = await this.getTrans('CHECKOUT_ADDRESS_REQUIRED');\n        return this.showToast(message);\n      } else if (this.form.controls['paymentMethod'].hasError('required')) {\n        const message = await this.getTrans('CHECKOUT_PAYMENT_METHOD_REQUIRED');\n        return this.showToast(message);\n      } else if (this.form.controls['card'].hasError('required')) {\n        const message = await this.getTrans('CHECKOUT_CARD_REQUIRED');\n        return this.showToast(message);\n      } else if (this.form.invalid) {\n        return this.translate.get('INVALID_FORM')\n          .subscribe(str => this.showToast(str));\n      }\n\n      this.isCreatingOrder = true;\n\n      const order = this.prepareOrderData();\n      await order.save();\n\n      this.isCreatingOrder = false;\n\n      window.dispatchEvent(new CustomEvent('cart:updated', {\n        detail: new Cart\n      }));\n\n      this.setRelativeRoot('./thanks/' + order.id);\n\n    } catch (error) {\n\n      if (error.code === 1001) {\n        this.translate.get('ACCOUNT_BLOCKED').subscribe((str) => this.showToast(str));\n      } else if (error.code === 1002) {\n        this.translate.get('CARD_DECLINED').subscribe((str) => this.showToast(str));\n      } else if (error.code === 1004) {\n\n        const matches = error.message.match(/\\%(.*?)\\%/);\n\n        if (matches) {\n          const value = matches[1];\n          const formattedValue = this.currencyGlobalPipe.transform(value);\n          this.translate.get('ERROR_MINIMUM_ORDER_AMOUNT', { value: formattedValue })\n            .subscribe(str => this.showToast(str));\n        }\n\n      } else if (error.code === 1005) {\n\n        const matches = error.message.match(/\\%(.*?)\\%/);\n\n        if (matches) {\n          const value = matches[1];\n          const formattedValue = this.currencyGlobalPipe.transform(value);\n          this.translate.get('ERROR_MAXIMUM_ORDER_AMOUNT', { value: formattedValue })\n            .subscribe(str => this.showToast(str));\n        }\n\n      } else if (error.code === 1006) {\n        this.onPresentSignUpModal();\n        this.translate.get('ERROR_CHECKOUT_GUEST_DISABLED')\n          .subscribe(str => this.showToast(str, 'top'));\n      } else {\n        this.showCouponErrorsIfNeeded(error);\n      }\n\n      this.isCreatingOrder = false;\n    }\n\n  }\n\n}\n"]}